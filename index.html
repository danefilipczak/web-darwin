<!DOCTYPE html>
<html>
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <script src="scripts/vexflow-min.js"></script>




<script>



 $(document).ready(function(){

   VF = Vex.Flow;

	// Create an SVG renderer and attach it to the DIV element named "boo".
	var div = document.getElementById("boo")
	var renderer = new VF.Renderer(div, VF.Renderer.Backends.SVG);

	// Configure the rendering context.
	renderer.resize(900, 200);
	var context = renderer.getContext();
	context.setFont("Arial", 10, "").setBackgroundFillStyle("#eed");

	// Create a stave of width 400 at position 10, 40 on the canvas.
	var stave = new VF.Stave(10, 40, 800);

	// Add a clef and time signature.
	stave.addClef("treble").addTimeSignature("4/4");

	// Connect it to the rendering context and draw!
	stave.setContext(context).draw();

	// geof's code

	 function newNote (keynum, dur) {

 	var oct = Math.floor( keynum / 12) - 1;
 	var pc = keynum % 12;

 	var notestr = VF.integerToNote(pc) + "/" + oct;
    //console.log(notestr);
    
 	var note = new VF.StaveNote({clef: "treble", keys: [ notestr ], duration: dur });

    if ( [1, 3, 6, 8, 10].indexOf(pc) != -1) { /// is a black note (always sharp)
    	note.addAccidental(0, new VF.Accidental("#"));
    }

 	return note;
 	}


 	function randVoice (len, dur) {

 		var notes = [];
 		for (i=0; i<len; i++) {
 			notes.push( newNote( Math.floor (Math.random() * 18) + 60, dur) );
 				}

 		// Create a voice in 4/4 and add above notes
		var voice = new VF.Voice({num_beats: 4,  beat_value: 4});
		voice.addTickables(notes);

		// Format and justify the notes to 750 pixels
		var formatter = new VF.Formatter().joinVoices([voice]).format([voice], 750);

		return voice;
 		}

    

 	$("#generate").click( function () {

 		var voice = randVoice(16, "16");

 		var beams = VF.Beam.generateBeams(voice.tickables);

 		// erase SVG contents
		$("svg").empty();

		// draw elements
		stave.draw();
		voice.draw(context, stave);
		// draw the damned beams (? not part of voice)
		beams.forEach(function(beam) {
  			beam.setContext(context).draw();
		});


	});

});

</script>
</head>

<body>
	<button id="generate">Generate Random Notes</button>
	
	<div class="panel panel-default" id="boo"></div>

</body>